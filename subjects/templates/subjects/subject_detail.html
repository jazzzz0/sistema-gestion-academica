{% extends "base.html" %}

{% block title %}{{ subject.name }}{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
    <div>
        <a href="{% url 'subjects:subject_list' %}" class="btn btn-outline-secondary btn-sm mb-2">
            <i class="bi bi-arrow-left"></i> Volver al listado
        </a>
        <h1 class="h3">{{ subject.name }}</h1>
    </div>

    <div>
        <a href="{% url 'subjects:subject_update' subject.pk %}" class="btn btn-warning me-2">
            Editar
        </a>
        <a href="{% url 'subjects:subject_delete' subject.pk %}" class="btn btn-danger">
            Eliminar
        </a>
    </div>
</div>

{% if subject.teacher %}
    <span class="badge bg-primary">
        Profesor Titular: {{ subject.teacher.surname }}, {{ subject.teacher.name }}
    </span>
{% else %}
    <span class="badge bg-secondary">Sin profesor asignado</span>
{% endif %}

<hr class="my-4">

<h2 class="h5 mb-3">Informaci贸n General</h2>

<div class="mb-4">
    <h6 class="fw-bold">Descripci贸n</h6>
    <p>
        {% if subject.description %}
            {{ subject.description }}
        {% else %}
            <span class="text-muted">Sin descripci贸n</span>
        {% endif %}
    </p>

    <h6 class="fw-bold">Cupo</h6>
    <p class="fs-5">
        <strong>{{ subject.enrollment_count }}</strong> / {{ subject.quota }} ocupados
    </p>

    <div class="progress" style="height: 10px; width: 200px;">
        {% widthratio subject.enrollment_count subject.quota 100 as percentage %}
        <div class="progress-bar {% if percentage|add:0 >= 100 %}bg-danger{% else %}bg-success{% endif %}"
             role="progressbar"
             style="width: {{ percentage }}%;"
             aria-valuenow="{{ subject.enrollment_count }}"
             aria-valuemin="0"
             aria-valuemax="{{ subject.quota }}">
        </div>
    </div>
</div>

<hr class="my-4">

<h2 class="h5 mb-3">Planes de Estudio</h2>

<ul class="list-group mb-4">
    {% for career in subject.careers.all %}
        <li class="list-group-item">
            {{ career.name }}
        </li>
    {% empty %}
        <p class="text-muted fst-italic">
            Esta materia no pertenece a ninguna carrera.
        </p>
    {% endfor %}
</ul>

<div class="mt-4">
    <button class="btn btn-outline-secondary" disabled>
        Ver Alumnos Inscritos (Pr贸ximamente)
    </button>
</div>

{% endblock %}