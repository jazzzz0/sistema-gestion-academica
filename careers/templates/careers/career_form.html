{% extends 'base.html' %}
{% load static %}

{% block title %}
  {% if form.instance.pk %}
    Editar Carrera
  {% else %}
    Nueva Carrera
  {% endif %}
{% endblock %}

{% block content %}
<div class="row justify-content-center mt-4">
  <div class="col-md-8 col-lg-6">
  
    <h1 class="h4 mb-4 fw-bold">
      {% if form.instance.pk %}
        Editar Carrera: {{ form.instance.name }}
      {% else %}
        Nueva Carrera
      {% endif %}
    </h1>

    <p class="text-muted small mb-4">
      {% if form.instance.pk %}
        Modifica los datos de la carrera y guarda los cambios.
      {% else %}
        Completa los datos para registrar una nueva carrera.
      {% endif %} 
    </p>

      {% if form.non_field_errors %}
        <div class="alert alert-danger py-2 mb-4">
          {% for err in form.non_field_errors %}
            <div><i class="bi bi-exclamation-circle me-2"></i>{{ err }}</div>
          {% endfor %}
        </div>
      {% endif %}

      {% if not form.instance.pk %}
        <div class="alert alert-info" role="alert">
          <i class="bi bi-info-circle"></i> La carrera se crear치 en estado <strong>inactivo</strong> (Borrador). Podr치 agregar materias y activarla desde el detalle de la carrera.
        </div>
      {% endif %}

      <form method="post" novalidate>
        {% csrf_token %}
        <div style="display:none;">
          {{ form.hidden_fields }}
        </div>

        <div class="card mb-4 shadow-sm">
          <div class="card-header bg-light">
            <h2 class="h6 fw-bold mb-0 text-primary">Datos de Carrera</h2>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <label for="{{ form.name.id_for_label }}" class="form-label">Nombre <span class="text-danger">*</span></label>
              <input
                type="text"
                name="{{ form.name.html_name }}"
                id="{{ form.name.id_for_label }}"
                value="{{ form.name.value|default_if_none:'' }}"
                class="form-control{% if form.name.errors %} is-invalid{% endif %}"
                placeholder="Ingrese el nombre de la carrera"
                required
                >
                  {% if form.name.help_text %}
                    <div class="form-text">{{ form.name.help_text }}</div>
                  {% endif %}
                  {% for error in form.name.errors %}
                    <div class="invalid-feedback">{{ error }}</div>
                  {% endfor %}
            </div>
            <div class="mb-3">
              <label for="{{ form.description.id_for_label }}" class="form-label">Descripci칩n</label>
              <textarea
                name="{{ form.description.html_name }}"
                id="{{ form.description.id_for_label }}"
                class="form-control{% if form.description.errors %} is-invalid{% endif %}"
                rows="6"
                placeholder="Descripci칩n amplia de la carrera (objetivos, perfil de egreso, etc.)"
              >{{ form.description.value|default_if_none:'' }}</textarea>
              {% for error in form.description.errors %}
                <div class="invalid-feedback">{{ error }}</div>
              {% endfor %}
            </div>
          </div>
        </div>
        
        <div class="d-flex justify-content-between mt-4">
          <a href="{% if form.instance.pk %}{% url 'careers:career_detail' form.instance.pk %}{% else %}{% url 'careers:career_list' %}{% endif %}"
            class="btn btn-outline-secondary text-decoration-none">
            Cancelar
          </a>

          <button type="submit" class="btn btn-primary px-4">
            {% if form.instance.pk %}
              Editar
            {% else %}
              Crear
            {% endif %}
          </button>
        </div>
      </form>
  </div>
</div>
{% endblock %}